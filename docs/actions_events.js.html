<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: actions/events.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: actions/events.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { action } from './action';
import firebase, { store } from '../firebase/FirebaseConfig';

/**
 * Auth Actions
 * @module actions/events
 *
 */

export const CREATE_EVENT = 'CREATE_EVENT';
export const CREATE_EVENT_FAILED = 'CREATE_EVENT_FAILED';

/**
 * Creates a new event in firebase.
 * @function
 * @param {Event} event New event to be created in db.
 * @param {Dispatch} dispatch
 */
export const createEvent = ( event, dispatch ) => {
  store.collection( 'events' ).add( event ).then( result => {
    event.eventId = result.id;
    dispatch( action( CREATE_EVENT, event ) );
  } ).catch( error => {
    console.log( error );
    dispatch( action( CREATE_EVENT_FAILED ) );
  } );
};

export const DELETE_EVENT = 'DELETE_EVENT';
export const DELETE_EVENT_FAILED = 'DELETE_EVENT_FAILED';

/**
 * Delete a event in the db.
 * @function
 * @param {String} eventId
 * @param {Dispatch} dispatch
 */
export const deleteEvent = ( eventId, dispatch ) => {
  store.collection( 'events' ).doc( eventId ).delete().then( res => {
    dispatch( action( DELETE_EVENT, eventId ) );
  } ).catch( error => {
    console.log( error );
    dispatch( action( DELETE_EVENT_FAILED ) );
  } );
};

export const EDIT_EVENT = 'EDIT_EVENT';
export const EDIT_EVENT_FAILED = 'EDIT_EVENT_FAILED';

/**
 * Update/Edit a event in the db.
 * @function
 * @param {Event} event Event to be updated.
 * @param {Dispatch} dispatch
 */
export const editEvent = ( event, dispatch ) => {
  store.collection( 'events' ).doc( event.eventId ).set( event ).then( res => {
    dispatch( action( DELETE_EVENT, event.eventId ) );
  } ).catch( error => {
    console.log( error );
    dispatch( action( DELETE_EVENT_FAILED ) );
  } );
};

export const GET_EVENTS_BY_ORG = 'GET_EVENTS_BY_ORG';
export const GET_EVENTS_BY_ORG_FAILED = 'GET_EVENTS_BY_ORG_FAILED';
export const ORG_HAS_NO_EVENTS = 'ORG_HAS_NO_EVENTS';

/**
 * Gets all events a organization has created.
 * @function
 * @param {String} orgId Organization Id.
 * @param {Dispatch} dispatch
 */
export const getAllEventsByOrg = ( orgId, dispatch ) => {
  store.collection( 'events' )
    .where( 'orgId', '==', orgId )
    .get()
    .then( res => {
      if( res.empty ){
        dispatch( action( ORG_HAS_NO_EVENTS ) );
        return;
      }
      
      const events = [];
      res.forEach( event => {
        let eventToAdd = event.data();
        eventToAdd.eventId = event.id;
        events.push( eventToAdd );
      } );
      
      dispatch( action( GET_EVENTS_BY_ORG, events ) );
      
    } )
    .catch( error => {
      console.log( error );
      dispatch( action( GET_EVENTS_BY_ORG_FAILED ) );
    } );
};

export const GET_EVENTS_BY_STATE = 'GET_EVENTS_BY_STATE';
export const GET_EVENTS_BY_STATE_FAILED = 'GET_EVENTS_BY_STATE_FAILED';
export const NO_EVENTS_FOR_THAT_STATE = 'NO_EVENTS_FOR_THAT_STATE';

/**
 * Get all the events for a given state.
 * @function
 * @param {String} state Two digit state code
 * @param {Dispatch} dispatch
 */
export const getAllEventsByState = ( state, dispatch ) => {
  store.collection( 'events' )
    .where( 'state', '==', state )
    .get()
    .then( res => {
      if( res.empty ){
        dispatch( action( NO_EVENTS_FOR_THAT_STATE ) );
        return;
      }
      
      const events = [];
      res.forEach( event => {
        const data = event.data();
        data.eventId = event.id;
        events.push( data );
      } );
      
      dispatch( action( GET_EVENTS_BY_STATE, events ) );
      
    } )
    .catch( err => {
      console.log( err );
      dispatch( GET_EVENTS_BY_STATE_FAILED, err );
    } );
  
};

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-actions_auth.html">actions/auth</a></li><li><a href="module-actions_events.html">actions/events</a></li><li><a href="module-actions_organizations.html">actions/organizations</a></li><li><a href="module-Types.html">Types</a></li></ul><h3>Global</h3><ul><li><a href="global.html#action">action</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Sep 17 2019 11:35:11 GMT-0600 (Mountain Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
